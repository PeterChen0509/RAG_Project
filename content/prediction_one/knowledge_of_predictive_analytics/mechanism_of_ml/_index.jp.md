---
title: "5 機械学習の仕組み"
date: 2018-12-29T11:02:05+06:00
lastmod: 2020-01-05T10:42:26+06:00
weight: 5
draft: false
# metaタグのパラメータ
meta:
  description: ""
# クラウド・デスクトップ限定ページの場合は片方のみtrueにする
visible:
  is_cloud_only: false
  is_desktop_only: false
# 検索でヒットする文字列の指定
keywords: ["予測分析", "機械学習", "AI", "予測", "データサイエンス", "基礎"]
---

<!-- 参考資料 -->
<!-- SCKセミナー資料 -->

<style>
  summary {
    position: relative;
    display: block; /* 矢印を消す */
    padding: 10px;
    padding-left: 25px;
    cursor: pointer;
    background-color: #E7F2FA;
    transition: 0.0s;
  }
  summary:hover {
    background-color: #E7F2FA;
  }
  summary::-webkit-details-marker {
    display: none;
  }
  /* 疑似要素でアイコンを表示 */
  summary::before,
  summary::after {
    content: "";
    margin: auto;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
  }
  summary::before {
    width: 20px;
    height: 20px;
    border-radius: 50em;
    background-color: #6AB0DE;
  }
  summary::after {
    left: 8px;
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 4px 0 4px 8px;
    border-color: transparent transparent transparent #fff;
    box-sizing: border-box;
    transition: 0.0s;
  }
  /* オープン時 */
  details {
    padding: 5px;
  }
  details[open] {
    background-color: #F9F9F9;
  }
  details[open] summary {
    background-color: #E7F2FA;
  }
  details[open] summary::after {
    transform: rotate(90deg);
    left: 6px;
    top: 2px;
  }
</style>

データから自動的にルールやパターンを見い出すことを「<b>学習</b>」、未知の新しいデータに対してこのルールやパターンを適用することを「<b>予測</b>」といいます（参考：「<b>{{% a_in "../about_ml/" "4 機械学習とは" %}}</b>」）。ここではこの「学習」や「予測」といった機械学習の仕組みについて不動産の成約価格予測を例に簡単な式を用いながらイメージを説明します。<br/>
 <br/>
![](../img/t_slide27.png)
 <br/>

見い出したルールやパターンをもって予測を行うものを<b>機械学習モデル</b>や<b>予測モデル</b>または単に<b>モデル</b>と呼ぶことがあります。予測モデルにおける「予測」はコンピュータによる処理ですので、内部的には数字の大きさの大小比較や四則演算による数理的処理によって行われます。つまり予測モデルとは「データを入力して結果を出力するような数理的処理」です。では不動産のデータを入れて成約価格を出力するような数理的処理としてどんなものが適切でしょうか？<br/>
 <br/>
![](../img/t_slide28.png)
 <br/>

色々な数理的処理が考えられ特にこれといった正解はないですが、ここでは簡単に以下のような式を考えてみました。「成約価格＝ a × (築年数) + b × (日当たりが良い) + c × (日当たりが悪い) + d」という式です。あとはこの a, b, c, d を決めれば実際に不動産の成約価格を計算できる、つまり予測モデルが完成します。<br/>
ここで登場した「a, b, c, d」は<b>パラメータ</b>と呼ばれるものです。機械学習はデータから自動的にルールやパターンを見い出す技術と説明してきましたが、この「ルールやパターン」の実態は「a, b, c, d」のようなパラメータ、つまり複数の数値なのです。<br/>
 <br/>
![](../img/t_slide29.png)
 <br/>

パラメータ「a, b, c, d」を決めれば予測モデルが完成しますが、このパラメータはどのように決めればよいでしょう？適当にそれらしい値として、a = -2, b = 10, c = -6, d = 110 という値を入れてみました。まず、成約価格の基準値のような役割として d = 110 としました。他は基準値からの調整項として、築年数は増えるほど価格が下がりそうなので a = -2 を、日当たりは良ければ価格が上がり悪ければ価格が下がりそうなので b = 10, c = -6 を入れてみました。<br/>
予測モデルとは「データを入力して結果を出力するような数理的処理」であったことを思い出すと、この式に築年数や日当たりのデータを入れると成約価格という結果を出力できるので、これで予測モデルの完成です。<br/>
 <br/>
![](../img/t_slide30.png)
 <br/>

では予測モデルができたので実際に予測をしてみます。物件ID00001は築年数が4年で日当たりが良いので、「成約価格＝ -2 × (4) + 10 × (1) - 6 × (0) + 110 ＝ 112万」となります。実際の成約価格は100万なので誤差12万で予測ができたことになります。<br/>
 <br/>
![](../img/t_slide31.png)
 <br/>

適当にそれらしい値として決めた a = -2, b = 10, c = -6, d = 110 というパラメータで、物件ID00001は誤差12万で予測ができましたが他の物件ではどうでしょう？これは良いパラメータだったのでしょうか？果たしてこの予測モデルは良い予測が行えるのでしょうか？<br/>
一般的に正確に（＝誤差が小さく）予測できるモデルが良い予測モデルと考えられます。ですので、データ全体に対して実際の値と予測の値の誤差をそれぞれ計算しそれらが小さいモデルが良い予測モデルです。つまり誤差が小さくなるようにパラメータを決定すればよいということになります。<br/>
 <br/>
![](../img/t_slide32.png)
 <br/>

実際に、機械学習における「学習」のステップではデータに対して誤差の小さくなるパラメータを探索します。<br/>
様々な手法がありこの資料の範囲外となるため詳しくは説明を省きますが、1つ簡単な方法として以下が挙げられます。
- まず a, b, c, d をランダムに決定する
- これを100回繰り返し100個の予測モデルを作成する
- それぞれの予測モデルでデータ全体に対する誤差を計算し、最も誤差が小さかったパラメータを採用する
<br/>

無駄な計算が多くなってしまうので実際にはこのような手法が使われることはないですが、基本的な原理としては「データに対して誤差が小さくなるパラメータを決定すること」が学習であり、これが機械学習がデータから自動で見い出した「ルールやパターン」に当たります。<br/>
 <br/>

機械学習の仕組みに関する簡単な説明は以上になります。「データから自動的にルールやパターンを見い出す」というと何かロボットのような人工知能が勉強をしているようなイメージが浮かんでしまいますが、中身はこのページで紹介した数式のような数理的処理で表されていて、パラメータ（a, b, c, d）が「ルールやパターン」の実態でした。そして「学習」とは良いパラメータをデータから自動で決定すること、「予測」とは未知のデータに対して決定したパラメータを用いた計算結果を出力することです。<br/>

<details>
<summary style="font-weight:bold">発展的内容</summary>

パラメータにはこのページで紹介した学習時に調整されるパラメータのほかに、事前に決定しておく<b>ハイパーパラメータ</b>というものがあります。ハイパーパラメータはどのような挙動の機械学習モデルを使うのかを決定するもので、学習時にこのハイパーパラメータが変わることはありません。ハイパーパラメータは数値とは限りません。<br/>
 <br/>
例えば今回、<br/>
「成約価格＝ a × (築年数) + b × (日当たりが良い) + c × (日当たりが悪い) + d」<br/>
という築年数に対して線形の挙動をする（築年数が1増えたら成約価格がa増える）予測モデルを使いましたが、<br/>
「成約価格＝ a × (築年数<b>の2乗</b>) + b × (日当たりが良い) + c × (日当たりが悪い) + d」<br/>
というような非線形の（線形でない）予測モデルも考えられます。このときのハイパーパラメータは「線形 or 非線形」となります。<br/>
つまり大雑把に、ハイパーパラメータは機械学習モデルの設定値である、とも捉えられます。<br/>
 <br/>
ここではハイパーパラメータとして簡単な例を用いましたが、実際は多くの種類と取りえる値があります。また、ハイパーパラメータは学習時に調整されないため、どんなハイパーパラメータが適切であるのか？といった調整作業を、学習とは別のプロセスで行うこともあります。例えば、ハイパーパラメータの候補を複数用意しておき、その候補の数だけ学習を行い最も良い予測を行えた候補を採用する方法などがあります。<br/>
 <br/>
Prediction Oneではハイパーパラメータの調整も内部で自動的に行っているため、特に気を遣う必要はありません。

</details>
